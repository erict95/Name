import RPi.GPIO as GPIO
import time
import gspread
from oauth2client.service_account import ServiceAccountCredentials

scope = ['https://spreadsheets.google.com/feeds', 'https://www.googleapis.com/auth/drive']
credentials = ServiceAccountCredentials.from_json_keyfile_name('motion.json', scope)
gc = gspread.authorize(credentials)

wks = gc.open('Motion Sensor Data').sheet1

GPIO.setwarnings(False)
GPIO.setmode(GPIO.BOARD)
GPIO.setup(11,GPIO.IN)
GPIO.setup(15,GPIO.OUT)
GPIO.setup(13,GPIO.OUT)
GPIO.setup(7,GPIO.OUT)

count = 0

while True:
        i = GPIO.input(11)
        if i == 0:
            print ("no intruders", i)
            GPIO.output(7,0)
            GPIO.output(15,0)
            GPIO.output(13,0)
            time.sleep(1)
        elif i == 1:
            count += 1
            print ("motion detected", i)
            wks.append_row([count, time.strftime("%D") , time.strftime("%H:%M:%S")])
            GPIO.output(7,1)
            time.sleep(2)
            GPIO.output(13,1)
            time.sleep(2)
            GPIO.output(15,1)
            time.sleep(4)
            GPIO.output(7,0)
            GPIO.output(15,0)
            GPIO.output(13,0)
